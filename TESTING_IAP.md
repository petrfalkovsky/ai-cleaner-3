# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ In-App Purchases –≤ AI Cleaner

## üéØ –û–±–∑–æ—Ä

–ü—Ä–µ–º–∏—É–º-—Ñ—É–Ω–∫—Ü–∏—è "–†–∞–∑–º—ã—Ç—ã–µ —Ñ–æ—Ç–æ" (Blurry Photos) –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞ paywall. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏ –≤–∏–¥—è—Ç **–∑–æ–ª–æ—Ç–æ–π –∑–∞–º–æ—á–µ–∫** –Ω–∞ —ç—Ç–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ –ø—Ä–∏ —Ç–∞–ø–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —ç–∫—Ä–∞–Ω –ø–æ–∫—É–ø–∫–∏.

---

## üß™ –°–ø–æ—Å–æ–±—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–∫—É–ø–æ–∫

### –°–ø–æ—Å–æ–± 1: StoreKit Configuration (–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

–≠—Ç–æ —Å–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ - –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ App Store Connect.

#### –®–∞–≥–∏:

1. **–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–µ–∫—Ç –≤ Xcode:**
   ```bash
   open ios/Runner.xcworkspace
   ```

2. **–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å StoreKit Configuration:**
   - –í Xcode: `Product` ‚Üí `Scheme` ‚Üí `Edit Scheme...`
   - –í–∫–ª–∞–¥–∫–∞ `Run` ‚Üí `Options`
   - –í —Ä–∞–∑–¥–µ–ª–µ `StoreKit Configuration` –≤—ã–±—Ä–∞—Ç—å: `Configuration.storekit`
   - –ù–∞–∂–∞—Ç—å `Close`

3. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   flutter run
   ```

4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–∫—É–ø–∫—É:**
   - –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é "–†–∞–∑–º—ã—Ç—ã–µ" —Å –∑–∞–º–æ—á–∫–æ–º üîí
   - –û—Ç–∫—Ä–æ–µ—Ç—Å—è —ç–∫—Ä–∞–Ω Paywall
   - –ù–∞–∂–º–∏—Ç–µ "Start Free Trial"
   - –ü–æ—è–≤–∏—Ç—Å—è iOS –¥–∏–∞–ª–æ–≥ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–ª–æ–∫–∞–ª—å–Ω—ã–π, –Ω–µ —Ä–µ–∞–ª—å–Ω—ã–π)
   - –ù–∞–∂–º–∏—Ç–µ "Subscribe" –∏–ª–∏ "Buy"
   - ‚úÖ Premium –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è, –∑–∞–º–æ—á–µ–∫ –∏—Å—á–µ–∑–Ω–µ—Ç

5. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏:**
   - –í Xcode: `Debug` ‚Üí `StoreKit` ‚Üí `Manage Transactions`
   - –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–º–µ–Ω–∏—Ç—å, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏–ª–∏ —É–¥–∞–ª–∏—Ç—å –ø–æ–∫—É–ø–∫–∏

---

### –°–ø–æ—Å–æ–± 2: Sandbox Testing (App Store Connect)

–¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ App Store Connect –∏ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

#### –®–∞–≥–∏:

1. **–°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–¥—É–∫—Ç –≤ App Store Connect:**
   - –ó–∞–π—Ç–∏ –≤ App Store Connect
   - –í—ã–±—Ä–∞—Ç—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
   - `Features` ‚Üí `In-App Purchases`
   - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π Non-Consumable –ø—Ä–æ–¥—É–∫—Ç
   - Product ID: `ai_cleaner_premium_trial`
   - Reference Name: `Premium Trial`
   - Price: Free Trial + $9.99

2. **–°–æ–∑–¥–∞—Ç—å Sandbox —Ç–µ—Å—Ç–µ—Ä–∞:**
   - `Users and Access` ‚Üí `Sandbox Testers`
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ —Ç–µ—Å—Ç–µ—Ä–∞
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π email (–º–æ–∂–Ω–æ —Ñ–µ–π–∫–æ–≤—ã–π)

3. **–í—ã–π—Ç–∏ –∏–∑ App Store –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ:**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí App Store ‚Üí –≤—ã–π—Ç–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞

4. **–ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   flutter run --release
   ```

5. **–ü—Ä–∏ –ø–æ–∫—É–ø–∫–µ:**
   - –í–æ–π–¥–∏—Ç–µ –∫–∞–∫ Sandbox —Ç–µ—Å—Ç–µ—Ä
   - –°–æ–≤–µ—Ä—à–∏—Ç–µ –ø–æ–∫—É–ø–∫—É

---

### –°–ø–æ—Å–æ–± 3: –†—É—á–Ω–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è (–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏) üõ†Ô∏è

–î–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è UI –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ø–æ–∫—É–ø–∫–∏.

#### –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å Premium –≤—Ä—É—á–Ω—É—é:

```dart
// –í –ª—é–±–æ–º –º–µ—Å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ debug –ø–∞–Ω–µ–ª–∏)
import 'package:ai_cleaner_2/feature/premium/domain/premium_service.dart';

// –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å
PremiumService().enablePremiumForTesting();

// –î–µ–∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å
PremiumService().disablePremiumForTesting();
```

#### –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –≤ Settings Screen

```dart
// –í SettingsScreen –¥–æ–±–∞–≤—å—Ç–µ:
CupertinoButton(
  child: Text('üîì Enable Premium (DEV)'),
  onPressed: () {
    PremiumService().enablePremiumForTesting();
    ScaffoldMessenger.of(context).showSnackBar(
      SnackBar(content: Text('Premium activated!')),
    );
  },
)
```

---

## üì± –¢–µ—Å—Ç–æ–≤—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

‚úÖ **–ë–µ–∑ Premium:**
- [ ] –ö–∞—Ç–µ–≥–æ—Ä–∏—è "–†–∞–∑–º—ã—Ç—ã–µ" –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–æ–ª–æ—Ç–æ–π –∑–∞–º–æ—á–µ–∫ üîí
- [ ] –ü—Ä–∏ —Ç–∞–ø–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è Paywall —ç–∫—Ä–∞–Ω
- [ ] –ù–µ–ª—å–∑—è –æ—Ç–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–º—ã—Ç—ã—Ö —Ñ–æ—Ç–æ

‚úÖ **–° Premium:**
- [ ] –ó–∞–º–æ—á–µ–∫ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –ü—Ä–∏ —Ç–∞–ø–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–ø–∏—Å–æ–∫ —Ä–∞–∑–º—ã—Ç—ã—Ö —Ñ–æ—Ç–æ
- [ ] –ú–æ–∂–Ω–æ –≤—ã–±–∏—Ä–∞—Ç—å –∏ —É–¥–∞–ª—è—Ç—å —Ñ–æ—Ç–æ

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Paywall —ç–∫—Ä–∞–Ω–∞

- [ ] –ê–Ω–∏–º–∞—Ü–∏—è –∫–æ—Ä–æ–Ω—ã —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ê–Ω–∏–º–∞—Ü–∏—è Storage –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ –º–µ—Å—Ç–∞
- [ ] Progress bar –º–µ–Ω—è–µ—Ç —Ü–≤–µ—Ç (–∫—Ä–∞—Å–Ω—ã–π ‚Üí –∑–µ–ª–µ–Ω—ã–π)
- [ ] –¢–æ–≥–ª "Trial enabled" —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –¶–µ–Ω–∞ $0.00 –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è
- [ ] –î–∞—Ç–∞ —á–µ—Ä–µ–∑ 3 –¥–Ω—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è
- [ ] –ö–Ω–æ–ø–∫–∞ "Start Free Trial" —Ä–∞–±–æ—Ç–∞–µ—Ç

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–∫—É–ø–∫–∏

- [ ] iOS –¥–∏–∞–ª–æ–≥ –ø–æ–∫—É–ø–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- [ ] –ü–æ—Å–ª–µ –ø–æ–∫—É–ø–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è Success –¥–∏–∞–ª–æ–≥
- [ ] –ó–∞–º–æ—á–µ–∫ –∏—Å—á–µ–∑–∞–µ—Ç
- [ ] –ö–∞—Ç–µ–≥–æ—Ä–∏—è "–†–∞–∑–º—ã—Ç—ã–µ" —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è
- [ ] –ú–æ–∂–Ω–æ –æ—Ç–∫—Ä—ã—Ç—å –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

- [ ] –ö–Ω–æ–ø–∫–∞ "Restore Purchases" —Ä–∞–±–æ—Ç–∞–µ—Ç
- [ ] –ü–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è Premium –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è
- [ ] –ó–∞–º–æ—á–µ–∫ –∏—Å—á–µ–∑–∞–µ—Ç

---

## üêõ Troubleshooting

### –ü—Ä–æ–¥—É–∫—Ç—ã –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–û—à–∏–±–∫–∞:** `No products found`

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ `Configuration.storekit` –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –≤ Scheme
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Product ID –≤ StoreKit —Ñ–∞–π–ª–µ: `ai_cleaner_premium_trial`
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

### –ü–æ–∫—É–ø–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ (—Ñ–∏–ª—å—Ç—Ä: `üîê PremiumService`)
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ StoreKit Configuration –∞–∫—Ç–∏–≤–µ–Ω
3. –í Xcode: `Debug` ‚Üí `StoreKit` ‚Üí `Clear Transaction History`

### Premium –Ω–µ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `üîê PremiumService: ‚úÖ Premium –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `PremiumService().isPremium` –≤ –∫–æ–¥–µ
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

## üìä –õ–æ–≥–∏

–í—Å–µ –¥–µ–π—Å—Ç–≤–∏—è PremiumService –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `üîê`:

```
üîê PremiumService: –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è...
üîê PremiumService: –ó–∞–≥—Ä—É–∂–µ–Ω–æ 1 –ø—Ä–æ–¥—É–∫—Ç–æ–≤
   - ai_cleaner_premium_trial: Premium Trial ($0.00)
üîê PremiumService: –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–∫—É–ø–∫—É: ai_cleaner_premium_trial
üîê PremiumService: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–∫–∏: ai_cleaner_premium_trial - purchased
üîê PremiumService: –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞! –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º Premium
üîê PremiumService: ‚úÖ Premium –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!
```

–°–ª–µ–¥–∏—Ç–µ –∑–∞ —ç—Ç–∏–º–∏ –ª–æ–≥–∞–º–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏!

---

## üéÅ Product Details

**Product ID:** `ai_cleaner_premium_trial`
**Type:** Non-Consumable
**Price:** Free Trial ‚Üí $9.99
**Trial Duration:** 3 days
**Features:**
- –î–æ—Å—Ç—É–ø –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–†–∞–∑–º—ã—Ç—ã–µ —Ñ–æ—Ç–æ"
- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–∞–∑–º—ã—Ç—ã—Ö —Ñ–æ—Ç–æ

---

## ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É?

–ü–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º —É–±–µ–¥–∏—Ç–µ—Å—å:

- [ ] Product ID —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å App Store Connect
- [ ] Sandbox —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ —É—Å–ø–µ—à–Ω–æ
- [ ] –£–±—Ä–∞–Ω—ã –≤—Å–µ `enablePremiumForTesting()` –≤—ã–∑–æ–≤—ã
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ —Ä–µ–∞–ª—å–Ω–æ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∫—É–ø–æ–∫
- [ ] Terms & Privacy —Å—Å—ã–ª–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã

---

–£–¥–∞—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è! üöÄ
